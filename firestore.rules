{
  "rules_version": "2",
  "service cloud.firestore": {
    "match /databases/{database}/documents": {
      "function isAuthenticated()": {
        "return request.auth != null;"
      },
      "function isOwner(userId)": {
        "return request.auth.uid == userId;"
      },

      "match /{document=**}": {
        "allow read": true
      },

      "match /users/{userId}": {
        "allow create": "if isOwner(userId);",
        "allow update": "if isOwner(userId);"
      },

      "match /problems/{problemId}": {
        "allow create": "if isAuthenticated();",
        "allow update": "if isOwner(resource.data.creator.userId);",
        "allow delete": "if isOwner(resource.data.creator.userId);"
      },

      "match /solutions/{solutionId}": {
        "allow create": "if isAuthenticated();",
        "allow update": "if isOwner(resource.data.creator.userId);",
        "allow delete": "if isOwner(resource.data.creator.userId);"
      },
      
      "match /ideas/{ideaId}": {
        "allow create": "if isAuthenticated();",
        "allow update": "if isOwner(resource.data.creator.userId);",
        "allow delete": "if isOwner(resource.data.creator.userId);"
      },
      
      "match /businesses/{businessId}": {
        "allow create": "if isAuthenticated();",
        "allow update": "if isOwner(resource.data.creator.userId);",
        "allow delete": "if isOwner(resource.data.creator.userId);"
      },

      "match /tags/{tag}": {
        "allow write": "if isAuthenticated();"
      }
    }
  }
}
